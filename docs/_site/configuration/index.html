<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Configuration | Teapot Documentation</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Configuration" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Teapot is open-source software that allows HTTP/WebDAV access to your existing storage." />
<meta property="og:description" content="Teapot is open-source software that allows HTTP/WebDAV access to your existing storage." />
<link rel="canonical" href="http://localhost:4000/teapot/configuration/" />
<meta property="og:url" content="http://localhost:4000/teapot/configuration/" />
<meta property="og:site_name" content="Teapot Documentation" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Configuration" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Teapot is open-source software that allows HTTP/WebDAV access to your existing storage.","headline":"Configuration","url":"http://localhost:4000/teapot/configuration/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/teapot/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/teapot/feed.xml" title="Teapot Documentation" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/teapot/">Teapot Documentation</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/teapot/">Teapot</a><a class="page-link" href="/teapot/how-teapot-works/">How Teapot works</a><a class="page-link" href="/teapot/installation_guide/">Installation Guide</a><a class="page-link" href="/teapot/configuration/">Configuration</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Configuration</h1>
  </header>

  <div class="post-content">
    <p>All configuration settings are stored in the <code class="language-plaintext highlighter-rouge">config.ini</code> file, located at
<code class="language-plaintext highlighter-rouge">/etc/teapot/</code>. To configure Teapot according to your requirements, follow the
instructions provided inside the file.</p>

<h2 id="certificates">Certificates</h2>

<p>Both Teapot and StoRM WebDAV servers require SSL certificates. The
certificate must also be added to the system’s trust store to ensure secure
communication. Path to the Teapot’s certificate should be specified in
<code class="language-plaintext highlighter-rouge">config.ini</code>. To generate self-signed certificates for StoRM WebDAV and add
them to the trust store, run <code class="language-plaintext highlighter-rouge">sudo /usr/share/teapot/self-signed-cert-gen.sh</code>.</p>

<h2 id="storm-webdav-configuration-files">Storm-webdav configuration files</h2>

<h3 id="storage-areas">Storage areas</h3>

<p>Teapot uses a pre-configured template for storage area configuration.
It can be found at:</p>

<ul>
  <li>Repository: <code class="language-plaintext highlighter-rouge">templates/storage_area.properties.template</code></li>
  <li>Installation: <code class="language-plaintext highlighter-rouge">/etc/teapot/storage_area.properties.template</code></li>
</ul>

<p>For user-specific storage areas, configuration files must be created manually
and added to <code class="language-plaintext highlighter-rouge">/var/lib/teapot/user-&lt;username&gt;/sa/&lt;storage_area&gt;.properties</code>.</p>

<p>To make any changes to the template, please refer to the
<a href="https://github.com/italiangrid/storm-webdav/blob/master/doc/storage-area-configuration.md">StoRM WebDAV Guidelines</a>
for detailed instructions.</p>

<h3 id="authorization-template">Authorization Template</h3>

<p>Teapot uses a template to define authorization to storage areas, found at:</p>

<ul>
  <li>Repository: <code class="language-plaintext highlighter-rouge">templates/application.yml.template</code></li>
  <li>Installation: <code class="language-plaintext highlighter-rouge">/etc/teapot/application.yml.template</code></li>
</ul>

<p>The template is pre-configured. To make any additional changes, please
refer to the <a href="https://github.com/italiangrid/storm-webdav/blob/master/doc/storage-area-configuration.md">StoRM WebDAV Guidelines</a>
for detailed instructions.</p>

<h2 id="mapping-users-global-and-local-identities">Mapping user’s global and local identities</h2>

<h3 id="file-based-mapping-method">File-based Mapping Method</h3>

<p>Teapot provides three methods for mapping a user’s global and local identities.
The first method is the File-based Mapping Method. Teapot allows manual
storage of user mappings in a file. This file should contain the following
information: for each user, the local username and the user’s OIDC subject
claim (sub), as provided by the Identity Provider (IdP). These values must
be listed on a single line, separated by a single space.</p>

<p>Example:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>user1 248289761001
user2 a12b3c4d5e6f
</code></pre></div></div>

<h3 id="alise-account-linking-service">ALISE - Account Linking Service</h3>

<p>The second method uses the ALISE - Account Linking Service
(<a href="https://github.com/m-team-kit/alise/tree/master/alise">ALISE documentation</a>).
ALISE allows users to log in with a single local account per site while linking
multiple global accounts.</p>

<p>To configure ALISE you must specify:</p>

<ul>
  <li>The ALISE instance that manages the required mappings.</li>
  <li>The computing center where local identities should be mapped.</li>
</ul>

<p>To access ALISE’s API, you first need to obtain an API key. This can be done
via the following endpoint:
<code class="language-plaintext highlighter-rouge">ALISE_INSTANCE + /api/v1/target/{site}/get_apikey</code>.
The API key is associated with a specific user and is obtained using an Access
Token. You can retrieve the API key via a <code class="language-plaintext highlighter-rouge">curl</code> request by including the
Access Token in the request header:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s2">"Authorization: Bearer </span><span class="k">${</span><span class="nv">ACCESS_TOKEN</span><span class="k">}</span><span class="s2">"</span> &lt;API_ENDPOINT&gt;
</code></pre></div></div>

<h3 id="vo-based-mapping">VO based mapping</h3>

<p>The third method is VO-based mapping, where all members of a Virtual
Organization (VO) are mapped to a single local identity. This is a
group-based mapping approach.</p>

<p>To configure VO-based mapping, specify:</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">eduperson-entitlement</code> that defines the VO membership.</li>
  <li>The local account to which users with the matching <code class="language-plaintext highlighter-rouge">eduperson-entitlement</code>
will be mapped.</li>
</ul>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/teapot/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Teapot Documentation</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Teapot Documentation</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Teapot is open-source software that allows HTTP/WebDAV access to your existing storage.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
